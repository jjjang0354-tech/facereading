
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ìƒìœ¼ë¡œ ë³´ëŠ” ìˆ˜ëŠ¥ ì„±ì í‘œ</title>
    <style>
body {
    font-family: sans-serif;
    background-color: #f0f2f5;
    color: #333;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-image: linear-gradient(to top right, #6a11cb, #2575fc);
}

.container {
    background-color: rgba(255, 255, 255, 0.9);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    text-align: center;
    max-width: 600px;
    width: 90%;
    backdrop-filter: blur(10px);
}

header h1 {
    font-size: 2.5rem;
    color: #333;
    margin-bottom: 0.5rem;
}

header p {
    color: #666;
    margin-bottom: 2rem;
}

.upload-section input[type="file"] {
    display: none;
}

.upload-section label {
    background-color: #007bff;
    color: white;
    padding: 1rem 2rem;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block;
    margin-bottom: 1rem;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

.upload-section label:hover {
    background-color: #0056b3;
    box-shadow: 0 6px 20px rgba(0, 123, 255, 0.5);
}

#predict-button {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
}

#predict-button:hover {
    background-color: #218838;
    box-shadow: 0 6px 20px rgba(40, 167, 69, 0.5);
}

.result-container {
    margin-top: 2rem;
}

.analyzing {
    font-size: 1rem;
    color: #444;
    padding: 1rem;
    background: rgba(255,255,255,0.7);
    border-radius: 8px;
    animation: pulse 1s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ê´€ìƒìœ¼ë¡œ ë³´ëŠ” ìˆ˜ëŠ¥ ì„±ì í‘œ</h1>
            <p>ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ ì „í†µ ê´€ìƒí•™ìœ¼ë¡œ ìˆ˜ëŠ¥ ì„±ì í‘œë¥¼ ì˜ˆì¸¡í•´ë“œë¦½ë‹ˆë‹¤.</p>
        </header>
        <main>
            <div class="upload-section">
                <input type="file" id="face-image" accept="image/*">
                <label for="face-image">ì‚¬ì§„ ì„ íƒ</label>
                <button id="predict-button">ê²°ê³¼ ë³´ê¸°</button>
            </div>
            <div id="result-container" class="result-container"></div>
        </main>
    </div>
    <script type="module">
// â”€â”€ score-report.js â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const PHYSIOGNOMY = {
    ì´ë§ˆ: {
        ë†’ìŒ: { í•´ì„: 'ìƒì •(ä¸Šåœ)ì´ ë„“ê³  ë¹›ë‚˜ ì‚¬ê³ ì˜ ê¸°ìš´ì´ ì¶©ë§Œí•¨',     ì„±í–¥: 'ìƒê°í˜• Â· ê³„íš ìš°ì„ ',   ë°ˆ: 'êµ­ì–´ ì§€ë¬¸ì„ ëê¹Œì§€ ì½ê³ ë„ ì‹œê°„ì´ ë‚¨ëŠ” íƒ€ì…' },
        ì¤‘ê°„: { í•´ì„: 'ìƒì •ì´ ê· í˜• ì¡í˜€ ì‚¬ê³ ì™€ í–‰ë™ì´ ê³ ë¦„',               ì„±í–¥: 'ê· í˜•í˜• Â· ìƒí™© ëŒ€ì‘',   ë°ˆ: '2ë…ì—ì„œ ê°‘ìê¸° ì´í•´ê°€ ì˜¤ëŠ” íƒ€ì…' },
        ë‚®ìŒ: { í•´ì„: 'ìƒì •ì˜ ê¸°ìš´ì´ ì‘ì¶•ë˜ì–´ í–‰ë™ ë³¸ëŠ¥ì´ ì•ì„¬',           ì„±í–¥: 'í–‰ë™í˜• Â· ì¦‰í¥ ëŒ€ì‘',   ë°ˆ: 'ì§€ë¬¸ ì½ê¸° ì „ ì„ ì§€ë¶€í„° í›‘ëŠ” ì „ëµê°€ íƒ€ì…' },
    },
    ëˆˆë§¤: {
        ë†’ìŒ: { í•´ì„: 'ì•ˆì‹ (çœ¼ç¥)ì´ ë˜ë ·í•˜ê³  ì§‘ì¤‘ì˜ ê¸°ìš´ì´ ê¹ŠìŒ',          ì„±í–¥: 'ë¶„ì„í˜• Â· ê¹Šì´ ì²˜ë¦¬',   ë°ˆ: 'í•œ ë¬¸ì œ 30ë¶„ ë¶™ì¡ê³  ê²°êµ­ ë§íˆëŠ” íƒ€ì…' },
        ì¤‘ê°„: { í•´ì„: 'ëˆˆë¹›ì´ ì•ˆì •ë˜ì–´ ë¹ ë¦„ê³¼ ê¹ŠìŒì´ ê· í˜•ì¡í˜',            ì„±í–¥: 'ê· í˜•í˜• Â· ì•ˆì • ì§‘ì¤‘',   ë°ˆ: '3ì ì§œë¦¬ëŠ” ë„˜ê¸°ê³  2ì ì§œë¦¬ ë‹¤ ë§íˆëŠ” í˜„ì‹¤ì£¼ì˜ íƒ€ì…' },
        ë‚®ìŒ: { í•´ì„: 'ëˆˆë§¤ê°€ ë¹ ë¥´ê³  ê°ê° ë°˜ì‘ì´ ë‚ ì¹´ë¡œì›€',                ì„±í–¥: 'ê°ê°í˜• Â· ë¹ ë¥¸ ë°˜ì‘',   ë°ˆ: 'ì§ê´€ ì°ê¸° ì •ë‹µë¥ ì´ ì˜ì™¸ë¡œ ë†’ì€ íƒ€ì…' },
    },
    ì½”: {
        ë†’ìŒ: { í•´ì„: 'ì¤€ë‘(æº–é ­)ê°€ ë†’ê³  ì‹¤í–‰ì˜ ê¸°ìš´ì´ ì¶©ë§Œí•¨',            ì„±í–¥: 'ëª©í‘œí˜• Â· ë†’ì€ ì¶”ì§„ë ¥', ë°ˆ: 'í‹€ë¦° ë¬¸ì œ ì´ìœ ë¥¼ ì˜¤ë‹µë…¸íŠ¸ 3ê¶Œì— ê¸°ë¡í•˜ëŠ” íƒ€ì…' },
        ì¤‘ê°„: { í•´ì„: 'ë¹„ëŸ‰(é¼»æ¢)ì´ ë°”ë¥´ê³  ì‹¤í–‰ê³¼ ì•ˆì •ì´ ê· í˜•ì¡í˜',        ì„±í–¥: 'ê· í˜•í˜• Â· ì•ˆì • ì‹¤í–‰',   ë°ˆ: 'ê³µë¶€ë„ í•˜ê³  ìœ íŠœë¸Œë„ ë³´ëŠ” ì ˆë¬˜í•œ ê· í˜• íƒ€ì…' },
        ë‚®ìŒ: { í•´ì„: 'ì½”ì˜ ê¸°ì„¸ê°€ ë¶€ë“œëŸ¬ì›Œ ì•ˆì • ì¶”êµ¬ ì„±í–¥ì´ ê°•í•¨',        ì„±í–¥: 'ì•ˆì •í˜• Â· ê¾¸ì¤€ ëˆ„ì ',   ë°ˆ: 'ìˆ˜ì—… í•„ê¸°ë§Œ ì™„ë²½í•´ë„ ë“±ê¸‰ì´ ë‚˜ì˜¤ëŠ” íƒ€ì…' },
    },
    ì…ìˆ : {
        ë†’ìŒ: { í•´ì„: 'êµ¬ê°(å£è§’)ì´ ëšœë ·í•˜ê³  í‘œí˜„ì˜ ê¸°ìš´ì´ ê°•í•¨',          ì„±í–¥: 'í‘œí˜„í˜• Â· ì–¸ì–´ ê°ê°',   ë°ˆ: "ë‹µ ì ìœ¼ë©´ì„œ í˜¼ì 'ë§ì§€?' í•˜ë©° ê³ ê°œ ë„ë•ì´ëŠ” íƒ€ì…" },
        ì¤‘ê°„: { í•´ì„: 'ì…ìˆ ì´ ê· í˜•ì¡í˜€ ë…¼ë¦¬ì™€ ê°ê°ì´ ì¡°í™”ë¡œì›€',            ì„±í–¥: 'ê· í˜•í˜• Â· ë…¼ë¦¬ì  í‘œí˜„', ë°ˆ: 'ì„ ì§€ ì½ë‹¤ ë³¸ëŠ¥ì ìœ¼ë¡œ ì •ë‹µì´ ëˆˆì— ë“¤ì–´ì˜¤ëŠ” íƒ€ì…' },
        ë‚®ìŒ: { í•´ì„: 'ìˆœë°•(è„£è–„)í•˜ê³  ë‚´í–¥ ë¶„ì„ ê¸°ì§ˆì´ ì„ ëª…í•¨',            ì„±í–¥: 'ë¶„ì„í˜• Â· ë‚´í–¥ì  ì‚¬ê³ ', ë°ˆ: 'ì¡°ìš©íˆ ê³µë¶€í•˜ë‹¤ ì‹œí—˜ì—ì„œ ë°˜ì „ ë³´ì—¬ì£¼ëŠ” íƒ€ì…' },
    },
    í„±: {
        ë†’ìŒ: { í•´ì„: 'ì§€ê°(åœ°é–£)ì´ ë„“ê³  ì§€ì†ì˜ ê¸°ìš´ì´ ë‘í…ê³  êµ³ìŒ',       ì„±í–¥: 'ì§€ì†í˜• Â· ì¥ê¸° ë‚´ê³µ',   ë°ˆ: 'ìˆ˜ëŠ¥ 3ë…„ ì¤€ë¹„í•´ë„ ì§€ì¹˜ì§€ ì•ŠëŠ” ì—­ì „ì˜ ìš©ì‚¬ íƒ€ì…' },
        ì¤‘ê°„: { í•´ì„: 'í•˜ì •(ä¸‹åœ)ì´ ì•ˆì •ì ì´ì–´ì„œ ì§€ì†ë ¥ì´ ê³ ë¦„',           ì„±í–¥: 'ê· í˜•í˜• Â· ì•ˆì • ì§€ì†',   ë°ˆ: '3ì£¼ í”Œëœ ì„¸ìš°ë©´ 2.5ì£¼ëŠ” ê¼­ ì§€í‚¤ëŠ” í˜„ì‹¤ íƒ€ì…' },
        ë‚®ìŒ: { í•´ì„: 'í„±ì´ ì˜ˆë¦¬í•˜ì—¬ ìˆœê°„ ì§‘ì¤‘ ê¸°ì§ˆì´ ê°•í•¨',               ì„±í–¥: 'ìˆœê°„í˜• Â· ë‹¨ê¸° ëª°ì…',   ë°ˆ: 'ìˆ˜ëŠ¥ ì „ë‚  ë°¤ìƒ˜ìœ¼ë¡œ 2ë“±ê¸‰ ë›°ì–´ì˜¤ë¥¼ ì ì¬ë ¥ ë³´ìœ ' },
    },
};

function getVariant(feature, brightness) {
    const variants = PHYSIOGNOMY[feature];
    if (!variants) return { í•´ì„: '-', ì„±í–¥: '-', ë°ˆ: '-' };
    if (brightness > 0.6)  return variants.ë†’ìŒ;
    if (brightness > 0.35) return variants.ì¤‘ê°„;
    return variants.ë‚®ìŒ;
}

class ScoreReport extends HTMLElement {
    constructor() {
        super();
        this.attachShadow({ mode: 'open' });
    }

    connectedCallback() {
        const studentName = this.getAttribute('student-name');
        const examNumber  = this.getAttribute('exam-number');
        const scores      = JSON.parse(this.getAttribute('scores'));

        const scoreRows = scores.map(s => {
            const std  = s.standardScore != null ? s.standardScore : '-';
            const pct  = s.percentile    != null ? s.percentile    : '-';
            return `
                <tr>
                    <td class="subject">${s.subject}</td>
                    <td class="elective">${s.elective}</td>
                    <td>${std}</td>
                    <td>${pct}</td>
                    <td class="grade g${s.grade}">${s.grade}</td>
                </tr>`;
        }).join('');

        const seen = new Set();
        const physiognomyRows = scores.filter(s => {
            if (seen.has(s.feature)) return false;
            seen.add(s.feature);
            return true;
        }).map(s => {
            const v = getVariant(s.feature, s.brightness ?? 0.5);
            return `
            <tr>
                <td class="feature-name">${s.feature}</td>
                <td class="feature-subject">${s.subject}${s.elective !== '-' ? ` (${s.elective})` : ''}</td>
                <td>
                    <div class="desc-wrap">
                        <div class="desc-í•´ì„">${v.í•´ì„}</div>
                        <div class="desc-row">
                            <span class="desc-ì„±í–¥">${v.ì„±í–¥}</span>
                            <span class="desc-ë°ˆ">${v.ë°ˆ}</span>
                        </div>
                    </div>
                </td>
            </tr>`;
        }).join('');

        this.shadowRoot.innerHTML = `
            <style>
                :host { display: block; font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif; }

                .report {
                    border: 2px solid #1a3a6b;
                    border-radius: 10px;
                    overflow: hidden;
                    background: #fff;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.12);
                }

                /* â”€â”€ í—¤ë” â”€â”€ */
                .report-header {
                    background: linear-gradient(135deg, #1a3a6b, #2e5fac);
                    color: #fff;
                    padding: 16px;
                    text-align: center;
                }
                .report-header .title {
                    font-size: 1rem;
                    font-weight: bold;
                    letter-spacing: 1px;
                    margin-bottom: 4px;
                }
                .report-header .subtitle {
                    font-size: 0.75rem;
                    opacity: 0.8;
                }

                /* â”€â”€ ìˆ˜í—˜ìƒ ì •ë³´ â”€â”€ */
                .student-info {
                    display: flex;
                    border-bottom: 1px solid #c8d4e8;
                    background: #f0f4fb;
                }
                .student-info .cell {
                    flex: 1;
                    padding: 8px 14px;
                    font-size: 0.85rem;
                }
                .student-info .cell span {
                    color: #1a3a6b;
                    font-weight: bold;
                    margin-right: 6px;
                }
                .student-info .cell + .cell {
                    border-left: 1px solid #c8d4e8;
                }

                /* â”€â”€ ì„±ì  í…Œì´ë¸” â”€â”€ */
                table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 0.88rem;
                }
                thead tr {
                    background: #e8edf8;
                    color: #1a3a6b;
                }
                th, td {
                    padding: 9px 10px;
                    border: 1px solid #c8d4e8;
                    text-align: center;
                }
                th { font-weight: bold; font-size: 0.82rem; }
                td.subject  { font-weight: 600; color: #1a3a6b; }
                td.elective { text-align: left; color: #555; font-size: 0.82rem; }

                .grade { font-weight: bold; font-size: 1rem; }
                .g1 { color: #c0392b; }
                .g2 { color: #e67e22; }
                .g3 { color: #d4ac0d; }
                .g4 { color: #27ae60; }
                .g5 { color: #2980b9; }
                .g6 { color: #8e44ad; }
                .g7, .g8, .g9 { color: #95a5a6; }

                /* â”€â”€ ê´€ìƒ ë¶„ì„ â”€â”€ */
                .physio-section {
                    border-top: 2px solid #c8d4e8;
                    background: #fdf8f0;
                }
                .physio-title {
                    background: linear-gradient(135deg, #6b3a1a, #ac5f2e);
                    color: #fff;
                    padding: 10px 14px;
                    font-size: 0.88rem;
                    font-weight: bold;
                    letter-spacing: 1px;
                }
                .physio-table th { background: #f5ede0; color: #6b3a1a; }
                .feature-name    { font-weight: bold; color: #6b3a1a; white-space: nowrap; }
                .feature-subject { color: #555; white-space: nowrap; font-size: 0.8rem; }

                .desc-wrap  { display: flex; flex-direction: column; gap: 4px; text-align: left; }
                .desc-í•´ì„  { color: #333; font-size: 0.8rem; }
                .desc-row   { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }
                .desc-ì„±í–¥  { font-size: 0.72rem; background: #e8edf8; color: #1a3a6b;
                               padding: 1px 7px; border-radius: 10px; font-weight: bold; white-space: nowrap; }
                .desc-ë°ˆ    { font-size: 0.75rem; color: #888; font-style: italic; }

                .footer {
                    font-size: 0.72rem;
                    color: #999;
                    padding: 8px 14px;
                    text-align: right;
                    border-top: 1px solid #e0e0e0;
                    background: #fafafa;
                }
            </style>

            <div class="report">
                <div class="report-header">
                    <div class="title">2025í•™ë…„ë„ ëŒ€í•™ìˆ˜í•™ëŠ¥ë ¥ì‹œí—˜ ì„±ì í†µì§€í‘œ</div>
                    <div class="subtitle">AI ì „í†µ ê´€ìƒí•™ ê¸°ë°˜ ì˜ˆì¸¡</div>
                </div>

                <div class="student-info">
                    <div class="cell"><span>ìˆ˜í—˜ë²ˆí˜¸</span>${examNumber}</div>
                    <div class="cell"><span>ì„±ëª…</span>${studentName}</div>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>ì˜ì—­</th>
                            <th>ì„ íƒê³¼ëª©</th>
                            <th>í‘œì¤€ì ìˆ˜</th>
                            <th>ë°±ë¶„ìœ„</th>
                            <th>ë“±ê¸‰</th>
                        </tr>
                    </thead>
                    <tbody>${scoreRows}</tbody>
                </table>

                <div class="physio-section">
                    <div class="physio-title">ğŸ”® ê´€ìƒ ì†Œê²¬ â€” í•™ìŠµ ì„±í–¥ ë¶„ì„</div>
                    <table class="physio-table">
                        <thead>
                            <tr>
                                <th>ê´€ìƒ ë¶€ìœ„</th>
                                <th>ì—°ê´€ ì˜ì—­</th>
                                <th>ê´€ìƒ ì†Œê²¬</th>
                            </tr>
                        </thead>
                        <tbody>${physiognomyRows}</tbody>
                    </table>
                </div>

                <div class="footer">â€» ë³¸ ê²°ê³¼ëŠ” ì „í†µ ê´€ìƒí•™ì„ í™œìš©í•œ AI ì˜ˆì¸¡ìœ¼ë¡œ, ì‹¤ì œ ì„±ì ê³¼ ë¬´ê´€í•©ë‹ˆë‹¤.</div>
            </div>
        `;
    }
}

customElements.define('score-report', ScoreReport);

// â”€â”€ main.js â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function getRegionBrightness(ctx, x, y, w, h) {
    const data = ctx.getImageData(
        Math.floor(x), Math.floor(y),
        Math.max(1, Math.floor(w)), Math.max(1, Math.floor(h))
    ).data;
    let total = 0;
    for (let i = 0; i < data.length; i += 4) {
        total += (data[i] + data[i + 1] + data[i + 2]) / 3;
    }
    return total / (data.length / 4) / 255; // 0~1 ì •ê·œí™”
}

function analyzeImage(file) {
    return new Promise((resolve) => {
        const img = new Image();
        const url = URL.createObjectURL(file);
        img.onload = () => {
            const canvas = document.createElement('canvas');
            canvas.width = 100;
            canvas.height = 100;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, 100, 100);
            URL.revokeObjectURL(url);
            resolve({
                ì´ë§ˆ: getRegionBrightness(ctx, 10,  0, 80, 20),
                ëˆˆ:   getRegionBrightness(ctx,  5, 20, 90, 20),
                ì½”:   getRegionBrightness(ctx, 25, 40, 50, 20),
                ì…:   getRegionBrightness(ctx, 15, 60, 70, 15),
                í„±:   getRegionBrightness(ctx, 20, 75, 60, 15),
            });
        };
        img.src = url;
    });
}

function weighted(brightness, min, max) {
    const range = max - min;
    const base = min + range * brightness;
    const noise = (Math.random() - 0.5) * range * 0.25;
    return Math.round(Math.min(max, Math.max(min, base + noise)));
}

function percentileToGrade(p) {
    if (p >= 96) return 1;
    if (p >= 89) return 2;
    if (p >= 77) return 3;
    if (p >= 60) return 4;
    if (p >= 40) return 5;
    if (p >= 23) return 6;
    if (p >= 11) return 7;
    if (p >= 4)  return 8;
    return 9;
}

function brightnessToAbsGrade(brightness) {
    return Math.max(1, Math.min(9, Math.round(9 - brightness * 8 + (Math.random() - 0.5) * 1.5)));
}

const EXPLORE_SOCIAL = ['ìƒí™œê³¼ ìœ¤ë¦¬', 'ìœ¤ë¦¬ì™€ ì‚¬ìƒ', 'í•œêµ­ì§€ë¦¬', 'ì„¸ê³„ì§€ë¦¬', 'ë™ì•„ì‹œì•„ì‚¬', 'ì„¸ê³„ì‚¬', 'ê²½ì œ', 'ì •ì¹˜ì™€ ë²•', 'ì‚¬íšŒÂ·ë¬¸í™”'];
const EXPLORE_SCIENCE = ['ë¬¼ë¦¬í•™â… ', 'í™”í•™â… ', 'ìƒëª…ê³¼í•™â… ', 'ì§€êµ¬ê³¼í•™â… '];

function generateScores(f) {
    const korPct  = weighted(f.ì´ë§ˆ, 1, 99);
    const mathPct = weighted(f.ëˆˆ,   1, 99);
    const exp1Pct = weighted(f.ì…,   1, 99);
    const exp2Pct = weighted(f.ì…,   1, 99);

    return [
        {
            subject: 'êµ­ì–´', elective: 'í™”ë²•ê³¼ ì‘ë¬¸',
            standardScore: weighted(f.ì´ë§ˆ, 100, 150), percentile: korPct,
            grade: percentileToGrade(korPct), feature: 'ì´ë§ˆ', brightness: f.ì´ë§ˆ,
        },
        {
            subject: 'ìˆ˜í•™', elective: 'í™•ë¥ ê³¼ í†µê³„',
            standardScore: weighted(f.ëˆˆ, 100, 149), percentile: mathPct,
            grade: percentileToGrade(mathPct), feature: 'ëˆˆë§¤', brightness: f.ëˆˆ,
        },
        {
            subject: 'ì˜ì–´', elective: '-',
            standardScore: null, percentile: null,
            grade: brightnessToAbsGrade(f.ì½”), feature: 'ì½”', brightness: f.ì½”,
        },
        {
            subject: 'í•œêµ­ì‚¬', elective: '-',
            standardScore: null, percentile: null,
            grade: brightnessToAbsGrade(f.í„±), feature: 'í„±', brightness: f.í„±,
        },
        {
            subject: 'íƒêµ¬',
            elective: EXPLORE_SOCIAL[Math.floor(Math.random() * EXPLORE_SOCIAL.length)],
            standardScore: weighted(f.ì…, 50, 75), percentile: exp1Pct,
            grade: percentileToGrade(exp1Pct), feature: 'ì…ìˆ ', brightness: f.ì…,
        },
        {
            subject: 'íƒêµ¬',
            elective: EXPLORE_SCIENCE[Math.floor(Math.random() * EXPLORE_SCIENCE.length)],
            standardScore: weighted(f.ì…, 50, 75), percentile: exp2Pct,
            grade: percentileToGrade(exp2Pct), feature: 'ì…ìˆ ', brightness: f.ì…,
        },
    ];
}

const STEPS = [
    { icon: 'ğŸ”®', text: 'ë™ì–‘ 5ì²œ ë…„ ê´€ìƒí•™ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ì† ì¤‘...' },
    { icon: 'ğŸ“', text: 'ì´ë§ˆ ë©´ì ì„ mmÂ² ë‹¨ìœ„ë¡œ ì •ë°€ ì¸¡ì •í•˜ì—¬ êµ­ì–´ ì ìˆ˜ë¡œ í™˜ì‚° ì¤‘...' },
    { icon: 'ğŸ‘ï¸', text: 'ëˆˆë¹›ì—ì„œ ê¸°ì¶œë¬¸ì œ í’€ì´ íšŸìˆ˜ë¥¼ ì—­ì¶”ì‚° ì¤‘ (ìˆ˜í•™)' },
    { icon: 'ğŸ‘ƒ', text: 'ì½§êµ¬ë© í™©ê¸ˆë¹„ìœ¨ì„ ì˜ì–´ ë“£ê¸° ëŠ¥ë ¥ì¹˜ë¡œ ë³€í™˜ ì¤‘...' },
    { icon: 'ğŸ‘„', text: 'ì¸ì¤‘ ê¹Šì´ë¡œ ê³µì‹ ì•”ê¸°ëŸ‰ì„ ì¶”ì •í•˜ëŠ” ì¤‘ (íƒêµ¬)' },
    { icon: 'ğŸ›ï¸', text: 'í„±ì˜ ë‚´êµ¬ì„±ì´ í•œêµ­ì‚¬ ì—°í‘œë¥¼ ë²„í‹¸ ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦ ì¤‘...' },
    { icon: 'ğŸ“œ', text: 'ìˆ˜ëŠ¥ ì¶œì œìœ„ì›íšŒì— ëª°ë˜ ì œì¶œ... ì•„ë‹ˆ, ìµœì¢… ì„±ì ì„ ì‚°ì¶œ ì¤‘' },
];

async function runAnalysis(file, resultContainer) {
    for (const step of STEPS) {
        resultContainer.innerHTML = `<p class="analyzing">${step.icon} ${step.text}</p>`;
        await new Promise(r => setTimeout(r, 550));
    }

    const features = await analyzeImage(file);
    const scores = generateScores(features);

    resultContainer.innerHTML = '';
    const scoreReport = document.createElement('score-report');
    scoreReport.setAttribute('student-name', 'í™ê¸¸ë™');
    scoreReport.setAttribute('exam-number', '10000101');
    scoreReport.setAttribute('scores', JSON.stringify(scores));
    resultContainer.appendChild(scoreReport);
}

document.getElementById('predict-button').addEventListener('click', () => {
    const fileInput = document.getElementById('face-image');
    const resultContainer = document.getElementById('result-container');

    if (fileInput.files.length === 0) {
        alert('ì‚¬ì§„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
    }

    runAnalysis(fileInput.files[0], resultContainer);
});
    </script>
</body>
</html>
